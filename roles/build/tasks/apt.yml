---
- name: Mark Oracle license selected
  become: yes
  debconf:
    name: oracle-java8-installer
    question: shared/accepted-oracle-license-v1-1
    value: 'true'
    vtype: select

- name: Mark Oracle license seen
  become: yes
  debconf:
    name: oracle-java8-installer
    question: shared/accepted-oracle-license-v1-1
    value: 'true'
    vtype: seen

- name: Install Oracle Java package
  become: yes
  apt: name=oracle-java8-installer state=present

- name: Install build packages
  become: yes
  apt:
    state: present
    name:
      - autoconf
      - bison
      - build-essential
      - elasticsearch
      - graphviz
      - imagemagick-6.q16
      - libffi-dev
      - libgdbm-dev
      - libmagickwand-6.q16-dev
      - libncurses-dev
      - libpq-dev
      - libreadline6-dev
      - libssl-dev
      - libyaml-dev
      - nodejs
      - postgresql
      - python-psycopg2
      - redis-server
      - shellcheck
      - sloccount
      - yarn
      - zlib1g-dev

- name: Create root user in Postgres
  become: yes
  become_user: postgres
  postgresql_user:
    name: root
    role_attr_flags: CREATEDB,CREATEROLE,SUPERUSER

- name: Create keegan user in Postgres
  become: yes
  become_user: postgres
  postgresql_user:
    name: keegan
    role_attr_flags: CREATEDB,CREATEROLE,SUPERUSER
